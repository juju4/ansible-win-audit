---

win_temp_dir: 'c:\Program Files\ansible'
win_log_dir: 'c:\ProgramData\ansible\log'

## Warning! Enabling all those will generate *lot* of logs
win_auditpol_enable:
  - Account Logon
  - Object Access
  - Privilege Use
  - Detailed Tracking
  - Policy Change
#  - DS Access
# https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-other-account-logon-events
  - Other Account Logon Events

win_auditpol_subcat_enable:
  - { cat: 'Account Management', sub: 'Application Group Management', fail: true, success: true }
  - { cat: 'Account Management', sub: 'Computer Account Management', fail: true, success: true }
  - { cat: 'Account Management', sub: 'Distribution Group Management', fail: true, success: true }
  - { cat: 'Account Management', sub: 'Security Group Management', fail: true, success: true }
  - { cat: 'Account Management', sub: 'User Account Management', fail: false, success: true }
  - { cat: 'DS Access', sub: 'Directory Service Changes', fail: false, success: true }
  - { cat: 'DS Access', sub: 'Directory Service Replication', fail: false, success: true }
# For DC
# https://adsecurity.org/wp-content/uploads/2017/04/2017-BSidesCharm-DetectingtheElusive-ActiveDirectoryThreatHunting-Final.pdf p50
#win_auditpol_subcat_enable:
#  - { cat: 'Account Logon', sub: 'Credential Validation', fail: true, success: true }
#  - { cat: 'Account Logon', sub: 'Kerberos Authentication Service', fail: true, success: true }
#  - { cat: 'Account Logon', sub: 'Kerberos Service Ticket Operations', fail: true, success: true }
#  - { cat: 'Account Management', sub: 'Application Group Management', fail: true, success: true }
#  - { cat: 'Account Management', sub: 'Computer Account Management', fail: true, success: true }
#  - { cat: 'Account Management', sub: 'Other Account Management', fail: true, success: true }
#  - { cat: 'Account Management', sub: 'Distribution Group Management', fail: true, success: true }
#  - { cat: 'Account Management', sub: 'Security Group Management', fail: true, success: true }
#  - { cat: 'Account Management', sub: 'User Account Management', fail: true, success: true }
#  - { cat: 'Detailed Tracking', sub: 'DPAPI Activity', fail: true, success: true }
#  - { cat: 'Detailed Tracking', sub: 'Process Creation', fail: true, success: true }
#  - { cat: 'DS Access', sub: 'Directory Service Access', fail: true, success: true }
#  - { cat: 'DS Access', sub: 'Directory Service Changes', fail: true, success: true }
#  - { cat: 'Logon and Logoff', sub: 'Account Lockout', fail: false, success: true }
#  - { cat: 'Logon and Logoff', sub: 'Logoff', fail: false, success: true }
#  - { cat: 'Logon and Logoff', sub: 'Logon', fail: true, success: true }
#  - { cat: 'Logon and Logoff', sub: 'Special Logon', fail: true, success: true }
#  - { cat: 'System', sub: 'IPSec Driver', fail: true, success: true }
#  - { cat: 'System', sub: 'Security State Change', fail: true, success: true }
#  - { cat: 'System', sub: 'Security System Extension', fail: true, success: true }
#  - { cat: 'System', sub: 'Security System Integrity', fail: true, success: true }

# https://blogs.technet.microsoft.com/jepayne/2015/11/26/tracking-lateral-movement-part-one-special-groups-and-specific-service-accounts/
win_audit_specialgroups_sid:
# Local Accounts
  - S-1-5-113 
# Domain Admins: 
#  - S-1-5-21-[DOMAIN]-512
# Enterprise Admins: 
#  - S-1-5-21-[FORESTROOTDOMAIN]-519
# Administrators (Could be noisy) 
  - S-1-5-32-544

# https://technet.microsoft.com/en-us/library/ff730951.aspx
win_audit_files: true
win_FileAuditRules: "Write,WriteData,Delete,DeleteSubdirectoriesAndFiles,ChangePermissions,Takeownership"
win_audit_filepaths:
  - C:\Users\Administrator\AppData\Local
  - C:\Users\Administrator\AppData\Roaming
  - C:\Users\Public
  - C:\Windows\System32\drivers\etc\hosts
  - C:\inetpub\wwwroot

win_audit_registry: true
win_RegAuditRules: "SetValue,Delete,ChangePermissions,TakeOwnership"
win_audit_regpaths:
  - 'HKCU:\Control Panel\Desktop'
  - 'HKCU:\Environment'
  - 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run'
  - 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce'
  - 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sethc.exe'
  - 'HKLM:\SOFTWARE\Microsoft\Windows Defender\Exclusions\Paths'
